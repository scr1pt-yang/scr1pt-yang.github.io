(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{459:function(s,t,a){"use strict";a.r(t);var r=a(2),e=Object(r.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("hr"),s._v(" "),t("h1",{attrs:{id:"一、总体步骤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、总体步骤"}},[s._v("#")]),s._v(" 一、总体步骤")]),s._v(" "),t("ol",[t("li",[s._v("搜索镜像")]),s._v(" "),t("li",[s._v("拉取镜像")]),s._v(" "),t("li",[s._v("查看镜像")]),s._v(" "),t("li",[s._v("启动镜像 - 服务端口映射")]),s._v(" "),t("li",[s._v("停止容器")]),s._v(" "),t("li",[s._v("移除容器")])]),s._v(" "),t("h1",{attrs:{id:"二、安装tomcat"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、安装tomcat"}},[s._v("#")]),s._v(" 二、安装tomcat")]),s._v(" "),t("h2",{attrs:{id:"_1、搜索镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、搜索镜像"}},[s._v("#")]),s._v(" 1、搜索镜像")]),s._v(" "),t("p",[s._v("在docker hub上面查找tomcat镜像"),t("br"),t("code",[s._v("docker search tomcat")]),t("br"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/scr1pt-yang/mypichost@main/img/docker-89.png",alt:""}})]),s._v(" "),t("h2",{attrs:{id:"_2、拉取镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、拉取镜像"}},[s._v("#")]),s._v(" 2、拉取镜像")]),s._v(" "),t("p",[s._v("从docker hub上拉取tomcat镜像到本地"),t("br"),t("code",[s._v("docker pull tomcat")]),t("br"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/scr1pt-yang/mypichost@main/img/docker-90.png",alt:""}})]),s._v(" "),t("h2",{attrs:{id:"_3、查看镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、查看镜像"}},[s._v("#")]),s._v(" 3、查看镜像")]),s._v(" "),t("p",[s._v("docker images查看是否有拉取到的tomcat"),t("br"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/scr1pt-yang/mypichost@main/img/docker-91.png",alt:""}})]),s._v(" "),t("h2",{attrs:{id:"_4、启动镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4、启动镜像"}},[s._v("#")]),s._v(" 4、启动镜像")]),s._v(" "),t("p",[s._v("使用tomcat镜像创建容器实例(也叫运行镜像)"),t("br"),t("code",[s._v("docker run -it -p 8080:8080 tomcat")])]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[s._v("-p 小写，主机端口:docker容器端口"),t("br"),s._v("其他参数在之前都有详细笔记，这里主要解释一下-p参数，它的作用是指定端口映射，因为tomcat默认是8080端口启动服务，这里我们如果想从外部主机访问容器内tomcat的话需要指定端口映射，将内部的8080端口映射到外部主机上，当然外部主机端口不一定就是8080，我们可以根据需求进行更改。"),t("br"),s._v("-P 大写，随机指定一个外部主机的空闲端口进行映射。")])]),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/scr1pt-yang/mypichost@main/img/docker-92.png",alt:""}}),t("br"),s._v("最后我们访问过来应该就能看到tomcat的主页了，假如出现404的情况，例如："),t("br"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/scr1pt-yang/mypichost@main/img/docker-93.png",alt:""}}),t("br"),s._v("可能是防火墙规则问题，可以去防火墙上放行指定端口或者关闭防火墙，也有可能是tomcat的webapps.dist目录问题，可以先检查一下容器是否正常启动，然后进入容器，查看webapps和webapps.dist目录，把webapps.dist目录换成webapps"),t("br"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/scr1pt-yang/mypichost@main/img/docker-94.png",alt:""}}),t("br"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/scr1pt-yang/mypichost@main/img/docker-95.png",alt:""}})]),s._v(" "),t("h1",{attrs:{id:"三、安装mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、安装mysql"}},[s._v("#")]),s._v(" 三、安装mysql")]),s._v(" "),t("h2",{attrs:{id:"_1、搜索镜像-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、搜索镜像-2"}},[s._v("#")]),s._v(" 1、搜索镜像")]),s._v(" "),t("p",[s._v("docker hub上面查找mysql镜像"),t("br"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/scr1pt-yang/mypichost@main/img/docker-96.png",alt:""}})]),s._v(" "),t("h2",{attrs:{id:"_2、拉取镜像-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、拉取镜像-2"}},[s._v("#")]),s._v(" 2、拉取镜像")]),s._v(" "),t("p",[s._v("从docker hub上(阿里云加速器)拉取mysql镜像到本地标签为5.7"),t("br"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/scr1pt-yang/mypichost@main/img/docker-97.png",alt:""}})]),s._v(" "),t("h2",{attrs:{id:"三、启动容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、启动容器"}},[s._v("#")]),s._v(" 三、启动容器")]),s._v(" "),t("p",[s._v("使用mysql5.7镜像创建容器(也叫运行镜像)"),t("br"),s._v("注意这里我们根据官方的提示，MySQL容器创建时需要给mysql应用指定一个root密码，设置"),t("code",[s._v("MYSQL_ROOT_PASSWORD")]),s._v("的值为我们自己的密码。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建MySQL容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(":3306 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" mysql:5.7\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看运行中的容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入到容器中")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" 容器ID /bin/bash\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 连接mysql")]),s._v("\nmysql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-uroot")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/scr1pt-yang/mypichost@main/img/docker-98.png",alt:""}}),t("br"),s._v("建库建表插入数据"),t("br"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/scr1pt-yang/mypichost@main/img/docker-99.png",alt:""}}),t("br"),s._v("因为做了端口映射，在外部主机也能根据IP和端口进行连接。"),t("br"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/scr1pt-yang/mypichost@main/img/docker-100.png",alt:""}}),t("br"),s._v("假如此时插入中文数据试试"),t("br"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/scr1pt-yang/mypichost@main/img/docker-101.png",alt:""}}),t("br"),s._v("会发现mysql报错，这是由于docker上默认字符集编码隐患，在docker里面的mysql容器实例内使用"),t("code",[s._v("SHOW VARIABLES LIKE 'character%'")]),s._v("命令查看。"),t("br"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/scr1pt-yang/mypichost@main/img/docker-102.png",alt:""}}),t("br"),s._v("字符集不统一，大部分都不是utf-8，插入中文报错。"),t("br"),s._v("使用卷挂载的方式将mysql的配置文件目录挂载进去，并修改位置文件添加字符集设定为utf-8。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新建一个容器实例")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(":3306 \n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--privileged")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true \n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /zzyyuse/mysql/log:/var/log/mysql \n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /zzyyuse/mysql/data:/var/lib/mysql \n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /zzyyuse/mysql/conf:/etc/mysql/conf.d \n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-eMYSQL_ROOT_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("  \n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" mysql mysql:5.7\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/scr1pt-yang/mypichost@main/img/docker-103.png",alt:""}}),t("br"),s._v("在主机的/zzyyuse/mysql/conf目录下创建一个my.cnf文件，通过容器卷同步给mysql容器实例。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# my.cnf文件内容如下：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("client"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("default_character_set")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ncollation_server "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" utf8_general_ci\ncharacter_set_server "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" utf8\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/scr1pt-yang/mypichost@main/img/docker-104.png",alt:""}}),t("br"),s._v("重新启动mysql容器实例再重新进入并查看字符编码"),t("br"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/scr1pt-yang/mypichost@main/img/docker-105.png",alt:""}}),t("br"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/scr1pt-yang/mypichost@main/img/docker-106.png",alt:""}}),t("br"),s._v("再新建库新建表再插入中文测试"),t("br"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/scr1pt-yang/mypichost@main/img/docker-107.png",alt:""}}),t("br"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/scr1pt-yang/mypichost@main/img/docker-108.png",alt:""}})]),s._v(" "),t("h1",{attrs:{id:"四、安装redis"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四、安装redis"}},[s._v("#")]),s._v(" 四、安装redis")]),s._v(" "),t("p",[s._v("后续更多安装操作包括redis容器安装部分见云原生实战章节。")])])}),[],!1,null,null,null);t.default=e.exports}}]);